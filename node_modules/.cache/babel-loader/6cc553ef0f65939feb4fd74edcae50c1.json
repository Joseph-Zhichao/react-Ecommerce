{"ast":null,"code":"import _objectSpread from\"/Users/josephzhu/Desktop/front-end-projects/eCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/Users/josephzhu/Desktop/front-end-projects/eCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/josephzhu/Desktop/front-end-projects/eCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/josephzhu/Desktop/front-end-projects/eCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/josephzhu/Desktop/front-end-projects/eCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/josephzhu/Desktop/front-end-projects/eCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/josephzhu/Desktop/front-end-projects/eCommerce/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from'react';import Client from'shopify-buy';var ShopContext=React.createContext();var client=Client.buildClient({storefrontAccessToken:\"dd4d4dc146542ba7763305d71d1b3d38\",domain:\"graphql.myshopify.com\"});var ShopProvider=/*#__PURE__*/function(_Component){_inherits(ShopProvider,_Component);var _super=_createSuper(ShopProvider);function ShopProvider(){var _this;_classCallCheck(this,ShopProvider);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={products:[],product:{},checkout:{},isCartOpen:false};_this.createCheckout=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var checkout;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return client.checkout.create();case 2:checkout=_context.sent;localStorage.setItem(\"checkout\",checkout.id);_this.setState({checkout:checkout});case 5:case\"end\":return _context.stop();}}},_callee);}));_this.fetchCheckout=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(checkoutId){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:client.checkout.fetch(checkoutId).then(function(checkout){_this.setState({checkout:checkout});}).catch(function(err){return console.log(err);});case 1:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.addItemToCheckout=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(variantId,quantity){var lineItemsToAdd,checkout;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:lineItemsToAdd=[{variantId:variantId,quantity:parseInt(quantity,10)}];_context3.next=3;return client.checkout.addLineItems(_this.state.checkout.id,lineItemsToAdd);case 3:checkout=_context3.sent;_this.setState({checkout:checkout});_this.openCart();case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x2,_x3){return _ref3.apply(this,arguments);};}();_this.fetchAllProducts=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var products;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return client.product.fetchAll();case 2:products=_context4.sent;_this.setState({products:products});case 4:case\"end\":return _context4.stop();}}},_callee4);}));_this.fetchProductWithId=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(id){var product;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return client.product.fetch(id);case 2:product=_context5.sent;_this.setState({product:product});return _context5.abrupt(\"return\",product);case 5:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref5.apply(this,arguments);};}();_this.closeCart=function(){_this.setState({isCartOpen:false});};_this.openCart=function(){_this.setState({isCartOpen:true});};return _this;}_createClass(ShopProvider,[{key:\"componentDidMount\",value:function componentDidMount(){//Check if localStorage has a checkout_id saved\nif(localStorage.checkout){this.fetchCheckout(localStorage.checkout);}else{this.createCheckout();}//if there is no checkout_id in localStorage then we will create a new checkout\n//else fetch the checkout from shopify\n}},{key:\"render\",value:function render(){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(ShopContext.Provider,{value:_objectSpread(_objectSpread({},this.state),{},{fetchAllProducts:this.fetchAllProducts,fetchProductWithId:this.fetchProductWithId,closeCart:this.closeCart,openCart:this.openCart,addItemToCheckout:this.addItemToCheckout})},this.props.children));}}]);return ShopProvider;}(Component);var ShopConsumer=ShopContext.Consumer;export{ShopConsumer,ShopContext};export default ShopProvider;","map":{"version":3,"sources":["/Users/josephzhu/Desktop/front-end-projects/eCommerce/src/context/shopContext.js"],"names":["React","Component","Client","ShopContext","createContext","client","buildClient","storefrontAccessToken","domain","ShopProvider","state","products","product","checkout","isCartOpen","createCheckout","create","localStorage","setItem","id","setState","fetchCheckout","checkoutId","fetch","then","catch","err","console","log","addItemToCheckout","variantId","quantity","lineItemsToAdd","parseInt","addLineItems","openCart","fetchAllProducts","fetchAll","fetchProductWithId","closeCart","props","children","ShopConsumer","Consumer"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport Client from 'shopify-buy'\n\nconst ShopContext = React.createContext();\n\nconst client = Client.buildClient({\n    storefrontAccessToken: \"dd4d4dc146542ba7763305d71d1b3d38\",\n    domain: \"graphql.myshopify.com\",\n  });\n\nclass ShopProvider extends Component {\n\n    state = {\n        products: [],\n        product:{},\n        checkout:{},\n        isCartOpen: false,\n    }\n\n\n    componentDidMount() {\n        //Check if localStorage has a checkout_id saved\n        if (localStorage.checkout) {\n            this.fetchCheckout(localStorage.checkout);\n        } else {\n            this.createCheckout();\n        }\n        //if there is no checkout_id in localStorage then we will create a new checkout\n    \n        //else fetch the checkout from shopify\n    }\n\n    createCheckout = async () => {\n        const checkout = await client.checkout.create();\n        localStorage.setItem(\"checkout\", checkout.id);\n        this.setState({checkout: checkout});\n    }\n\n    fetchCheckout = async (checkoutId) => {\n        client.checkout\n          .fetch(checkoutId)\n          .then((checkout) => {\n            this.setState({ checkout: checkout });\n          })\n          .catch((err) => console.log(err));\n    }\n\n    addItemToCheckout = async( variantId, quantity) => {\n        const lineItemsToAdd = [\n            {\n                variantId,\n                quantity: parseInt(quantity, 10),\n            }];\n\n        const checkout = await client.checkout.addLineItems(this.state.checkout.id,lineItemsToAdd);\n        this.setState({checkout: checkout});\n\n        this.openCart();\n    }\n\n    fetchAllProducts = async() => {\n        const products = await client.product.fetchAll();\n        this.setState({products: products});\n    }\n\n    fetchProductWithId = async(id) => {\n        const product = await client.product.fetch(id);\n        this.setState({product:product});\n        return product;\n    }\n\n    closeCart = () => { this.setState( {isCartOpen: false}) };\n\n    openCart = () => { this.setState( {isCartOpen: true}) };\n\n    render() {\n        return (\n            <div>\n                <ShopContext.Provider value = { {\n                    ...this.state,\n                    fetchAllProducts:this.fetchAllProducts,\n                    fetchProductWithId:this.fetchProductWithId,\n                    closeCart:this.closeCart,\n                    openCart:this.openCart,\n                    addItemToCheckout:this.addItemToCheckout\n                }}>\n                    {this.props.children}\n                </ShopContext.Provider>\n            </div>\n        )\n    }\n}\n\nconst ShopConsumer = ShopContext.Consumer;\n\nexport { ShopConsumer, ShopContext}\n\nexport default ShopProvider"]},"metadata":{},"sourceType":"module"}